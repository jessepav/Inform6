# :mode=makefile:

CC = gcc

DEFINES = -D PC_WIN32
CCOPTS = -c -O
LDOPTS = -Wl,-S

BINNAME = inform6.exe

SOURCES = $(wildcard *.c)
OBJECTS = $(patsubst %.c,%.o,${SOURCES})
PCH = header.h.gch

.PHONY: all clean

all:	$(BINNAME)

# Rules
$(PCH): header.h
	$(CC) $(DEFINES) $(CCOPTS) -x c-header -o $(PCH) header.h

%.o: %.c $(PCH)
	$(CC) $(DEFINES) $(CCOPTS) -o $@ -c $<

$(BINNAME): $(OBJECTS)
	$(CC) $(LDOPTS) -o $@ $^

clean:
	del /Q $(BINNAME)
	del /Q $(PCH)
	del /Q *.o
